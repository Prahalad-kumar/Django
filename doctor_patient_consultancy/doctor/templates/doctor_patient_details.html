{% extends "base.html" %}
{% block title %}Patient Details{% endblock %}
{% block nav_schedule %}active{% endblock %}

{% block extra_css %}
<style>
    .info-list { list-style:none;padding:0; display:grid; grid-template-columns:180px auto; gap:1rem; }
    .medical-history { white-space:pre-wrap; background:var(--bg-dark); padding:1rem; border-radius:8px; border:1px solid var(--border-color); color:var(--text-muted); }
</style>
{% endblock %}

{% block content %}
<h1 class="page-header">Patient: {{ patient.full_name }}</h1>

<div class="card">
    <h3>Personal Information</h3>
    <ul class="info-list">
        <li><strong>Full Name</strong></li><li>{{ patient.full_name }}</li>
        <li><strong>Gender</strong></li><li>{{ patient.gender }}</li>
        <li><strong>Email</strong></li><li>{{ patient.email }}</li>
        <li><strong>Contact</strong></li><li>{{ patient.phone_number }}</li>
        <li><strong>Date of Birth</strong></li><li>{{ patient.date_of_birth|date:"M d, Y" }}</li>
        <li><strong>Address</strong></li><li>{{ patient.address|default:"-" }}</li>
    </ul>
</div>

<div class="card">
    <h3>Medical History</h3>
    <div class="medical-history">{{ patient.medical_history|default:"No medical history recorded." }}</div>
</div>

<div class="card">
    <h3>Appointment History</h3>
    <ul class="appointment-list">
        {% if appointments %}
            {% for ap in appointments %}
            <li class="appointment-item">
                <div>
                    <span style="font-weight:700">{{ ap.doctor.fname }} {{ ap.doctor.lname }} ({{ ap.doctor.specialization }})</span>
                    <div class="appt-meta">{{ ap.appointment_date|date:"M d, Y" }} â€¢ {{ ap.appointment_time|time:"h:i A" }}</div>
                </div>
                <div>
                    <span class="status-badge {% if ap.status=='Pending' %}status-pending{% elif ap.status=='Approved' %}status-approved{% elif ap.status=='Cancelled' %}status-cancelled{% else %}status-completed{% endif %}">{{ ap.status }}</span>
                </div>
            </li>
            {% endfor %}
        {% else %}
            <li class="empty-state">No appointment history found for this patient.</li>
        {% endif %}
    </ul>
</div>
{% endblock %}
